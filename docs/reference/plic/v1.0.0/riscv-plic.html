<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RISC-V Platform-Level Interrupt Controller Specification :: RISC-V Ratified Specifications Library</title>
    <link rel="prev" href="introduction.html">
    <meta name="description" content="RISC-V PLIC Specification">
    <meta name="generator" content="Antora 3.1.12">
    <script>
!function (theme, navWidth) {
  if (theme === 'dark') document.documentElement.classList.add('dark-theme')
  if (navWidth) document.documentElement.style.setProperty('--nav-width', `${navWidth}px`)
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'),
  localStorage && localStorage.getItem('nav-width'))
    </script>
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/search.css">
    <link rel="stylesheet" href="../../_/css/vendor/page-search.css">
    <link rel="stylesheet" href="../../_/css/vendor/spring-tabs.css">

    <meta name="antora-ui-version" content="1e2798650bcf82e415abe50a131b399fc753d9ef"> 
    <meta name="version" content="v1.0.0">
    <meta name="component" content="plic">
    <meta name="latest-version" content="false">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body class="article">


<header class="header" id="antora-header">
    <nav class="navbar">
        <head>
            <link data-rh="true" rel="icon" href="/img/favicon.ico">
            <link data-rh="true" rel="canonical" href="https://developer.riscv.org/ref">
            <link data-rh="true" rel="alternate" href="https://developer.riscv.org/ref" hreflang="en">
            <link data-rh="true" rel="alternate" href="https://developer.riscv.org/ref" hreflang="x-default">
            <link data-rh="true" rel="preconnect" href="https://MGVPU7BN22-dsn.algolia.net" crossorigin="anonymous">
            <link rel="stylesheet" type="text/css" href="/docs/reference/_/docusaurus-styles-copy-08-25.css">

        </head>
        <script>
            !function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())
        </script>
            <link rel="preload" as="image" href="/img/logo.svg">
            <div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div>
            <div class="announcementBar_mb4j" role="banner">
                <div class="announcementBarPlaceholder_vyr4"></div>
                <div class="content_knG7 announcementBarContent_xLdY">congratulations, you found the RISC-V Developer Portal! 🎉 . This site is under active development and not meant for public consumption yet.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div>
            <nav aria-label="Main" class="navbar ">
                <div class="navbar__inner">
                    <div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button>
                        <a class="navbar__brand" href="/">
                            <div class="navbar__logo"><img src="/img/logo.svg" alt="RISC-V Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="RISC-V Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a>
                        <div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Specifications</a>
                            <ul class="dropdown__menu">
                                <li><a class="dropdown__link" href="/docs/spec/isa">ISA</a></li>
                                <li><a class="dropdown__link" href="/docs/spec/profiles">Profiles</a></li>
                                <li><a class="dropdown__link" docid="spec/non-isa" href="/docs/spec/non-isa">Non-ISA</a></li>
                            </ul>
                        </div>
                        <div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developers</a>
                            <ul class="dropdown__menu">
                                <li><a class="dropdown__link" href="/docs/spec/intro">Specification Developers</a></li>
                                <li><a class="dropdown__link" href="/docs/hardware/overview">Hardware Developers</a></li>
                                <li><a class="dropdown__link" href="/docs/software/overview">Software Developers</a></li>
                            </ul>
                        </div><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://riscv.org/community/calendar/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div>
                    <div class="navbar__items navbar__items--right">
                      <div class="navbarSearchContainer_Bca1">
                        <button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)">
                          <span class="DocSearch-Button-Container">
                            <svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true">
                              <path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                            <span class="DocSearch-Button-Placeholder">Search</span>
                          </span>
                          <span class="DocSearch-Button-Keys"></span>
                        </button>
                      </div>
                    </div>
                </div>
                <div role="presentation" class="navbar-sidebar__backdrop"></div>
            </nav>
            <div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper__tJE"></div>
        

    </nav>
</header><div class="body">
<div class="nav-container" data-component="plic" data-version="v1.0.0">
  <aside class="nav">
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
        <nav class="nav-menu">
<div class="context">
  <span class="title">RISC-V Platform-Level Interrupt Controller</span>
  <span class="version">v1.0.0</span>
  <button class="browse-version" id="browse-version">
    <svg
      height="24px"
      id="Layer_1"
      style="enable-background:new 0 0 512 512;"
      version="1.1"
      viewBox="0 0 512 512"
      width="24px"
      xml:space="preserve"
    ><g><path
          d="M256,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S273.7,224,256,224L256,224z"
        ></path><path
          d="M128.4,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S146,224,128.4,224L128.4,224z"
        ></path><path
          d="M384,224c-17.7,0-32,14.3-32,32s14.3,32,32,32s32-14.3,32-32S401.7,224,384,224L384,224z"
        ></path></g></svg>
  </button>
  </div><ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform-Level Interrupt Controller</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="contributor.html">Contributors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="changelog.html">Changelog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="licensing.html">Licensing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link"  href="riscv-plic.html">RISC-V Platform-Level Interrupt Controller </a>
  </li>
</ul>
  </li>
</ul>
          <div class="toggle-sm">
            <button id="nav-toggle-2" class="nav-toggle"></button>
          </div>
        </nav>
      </div>
      <div class="nav-collapse">
        <button id="nav-collapse-toggle"><span></span></button>        
      </div>
    </div>
    <div class="nav-resize"></div>
  </aside>
</div>
<script>
!function (sidebar) {
  if (sidebar) {
    document.body.classList.add('nav-sm')
  }
}(localStorage && localStorage.getItem('sidebar') === 'close')
</script><main class="article">
<div class="toolbar" role="navigation">
  <button id="nav-toggle-1" class="nav-toggle"></button>
</div>
  <div class="content">
<aside class="sidebar">
  <div class="content">
    <div
      class="toc"
      data-title="RISC-V Platform-Level Interrupt Controller Specification"
      data-levels="2"
    >
      <div class="toc-menu"></div>
    </div>
    <div class="sidebar-links">
        <a href="https://github.com/riscv/riscv-plic-spec/edit/antora-refactor/modules/ROOT/pages/riscv-plic.adoc">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            viewBox="0 0 24 24"
            width="24"
          ><path
              d="m16 2.012 3 3L16.713 7.3l-3-3zM4 14v3h3l8.299-8.287-3-3zm0 6h16v2H4z"
            ></path></svg>
          Edit this Page
        </a>
              <a href="https://github.com/riscv/riscv-plic-spec" title="GitHub">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          GitHub Project
        </a>

          <a href="https://github.com/riscv/docs.riscv.org/blob/main/static/pdf/riscv-plic-1.0.0.pdf" target="_blank" rel="noopener noreferrer" title="PDF" class="sidebar-link">
            <span>Download PDF</span>
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M10 14a5 5 0 0 1 7.07 0l3.54 3.54a5 5 0 0 1-7.07 7.07l-3.54-3.54a5 5 0 0 1 0-7.07z"/>
              <line x1="8" y1="8" x2="16" y2="16"/>
            </svg>
          </a>
      
    </div>
  </div>
</aside>
<article class="doc">
<div class="breadcrumbs-container">
  <nav class="breadcrumbs" aria-label="breadcrumbs">
    <ul>
      <li><a href="index.html">RISC-V Platform-Level Interrupt Controller</a></li>
      <li>Platform-Level Interrupt Controller</li>
      <li><a href="riscv-plic.html">RISC-V Platform-Level Interrupt Controller </a></li>
    </ul>
  </nav>
</div><h1 id="page-title" class="page">RISC-V Platform-Level Interrupt Controller Specification</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#change-log">Change Log</a>
<ul class="sectlevel2">
<li><a href="#version-1-0-0">version 1.0.0</a></li>
<li><a href="#version-1-0-0_rc6">version 1.0.0_rc6</a></li>
<li><a href="#version-1-0-0_rc5">version 1.0.0_rc5</a></li>
<li><a href="#version-1-0-0_rc4">version 1.0.0_rc4</a></li>
<li><a href="#version-1-0-0_rc3">version 1.0.0_rc3</a></li>
<li><a href="#version-1-0-0_rc2">version 1.0.0_rc2</a></li>
<li><a href="#version-1-0-0_rc1">version 1.0.0_rc1</a></li>
</ul>
</li>
<li><a href="#copyright-and-license-information">Copyright and license information</a></li>
<li><a href="#contributors">Contributors</a></li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#interrupt-targets-and-hart-contexts">1.1. Interrupt Targets and Hart Contexts</a></li>
<li><a href="#interrupt-gateways">1.2. Interrupt Gateways</a></li>
<li><a href="#interrupt-notifications">1.3. Interrupt Notifications</a></li>
<li><a href="#interrupt-identifiers-ids">1.4. Interrupt Identifiers (IDs)</a></li>
<li><a href="#interrupt-flow">1.5. Interrupt Flow</a></li>
</ul>
</li>
<li><a href="#risc-v-plic-operation-parameters">2. RISC-V PLIC Operation Parameters</a></li>
<li><a href="#memory-map">3. Memory Map</a></li>
<li><a href="#interrupt-priorities">4. Interrupt Priorities</a></li>
<li><a href="#interrupt-pending-bits">5. Interrupt Pending Bits</a></li>
<li><a href="#interrupt-enables">6. Interrupt Enables</a></li>
<li><a href="#priority-thresholds">7. Priority Thresholds</a></li>
<li><a href="#interrupt-claim-process">8. Interrupt Claim Process</a></li>
<li><a href="#interrupt-completion">9. Interrupt Completion</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">This document is in the <a href="http://riscv.org/spec-state">Ratified state</a></div>
<div class="paragraph">
<p>No changes are allowed. Any desired or needed changes can be the subject
of a follow-on new extension. Ratified extensions are never revised</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="change-log"><a class="anchor" href="#change-log"></a>Change Log</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="version-1-0-0"><a class="anchor" href="#version-1-0-0"></a>version 1.0.0</h3>
<div class="ulist">
<ul>
<li>
<p>2023-3-11</p>
<div class="ulist">
<ul>
<li>
<p>Ratified version</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc6"><a class="anchor" href="#version-1-0-0_rc6"></a>version 1.0.0_rc6</h3>
<div class="ulist">
<ul>
<li>
<p>2023-1-5</p>
<div class="ulist">
<ul>
<li>
<p>Remove H/U mode from this spec.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc5"><a class="anchor" href="#version-1-0-0_rc5"></a>version 1.0.0_rc5</h3>
<div class="ulist">
<ul>
<li>
<p>2022-10-29</p>
<div class="ulist">
<ul>
<li>
<p>Clarify the "register width" when access to memory map register.</p>
</li>
<li>
<p>Combine Register Width chapter and Memory Map chapter.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc4"><a class="anchor" href="#version-1-0-0_rc4"></a>version 1.0.0_rc4</h3>
<div class="ulist">
<ul>
<li>
<p>2022-8-27</p>
<div class="ulist">
<ul>
<li>
<p>Update specification to Frozen state.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc3"><a class="anchor" href="#version-1-0-0_rc3"></a>version 1.0.0_rc3</h3>
<div class="ulist">
<ul>
<li>
<p>2022-6-11</p>
<div class="ulist">
<ul>
<li>
<p>Revised Copyright and license information</p>
</li>
<li>
<p>Added Andrew Waterman and Krste Asanovic as contributors who did
the original design and wrote the spec.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc2"><a class="anchor" href="#version-1-0-0_rc2"></a>version 1.0.0_rc2</h3>
<div class="ulist">
<ul>
<li>
<p>2022-5-30</p>
<div class="ulist">
<ul>
<li>
<p>Revised the copyright statements to follow section 3.3 in Appendix
A "INTELLECTUAL PROPERTY RIGHTS POLICY " of the RISC-V Regulations.</p>
</li>
<li>
<p>Correct offsets of PLIC Interrupt Enable Bits memory map.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="version-1-0-0_rc1"><a class="anchor" href="#version-1-0-0_rc1"></a>version 1.0.0_rc1</h3>
<div class="ulist">
<ul>
<li>
<p>2022-4-16</p>
<div class="ulist">
<ul>
<li>
<p>The pre-public review version</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="copyright-and-license-information"><a class="anchor" href="#copyright-and-license-information"></a>Copyright and license information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This RISC-V PLIC specification is © 2017-2023 RISC-V international</p>
</div>
<div class="paragraph">
<p>This document is released under a Creative Commons Attribution 4.0
International License.<br>
<a href="https://creativecommons.org/licenses/by/4.0/" class="bare">creativecommons.org/licenses/by/4.0/</a>.</p>
</div>
<div class="paragraph">
<p>Please cite as: “RISC-V Platform-Level Interrupt Controller Specification",  RISC-V International</p>
</div>
<div class="paragraph">
<p>This document is a derivative of the "The RISC-V Instruction Set Manual, Volume II: Privileged Architecture, Document
version 1.9.1" released under following license: © 2010–2017 Andrew Waterman,
Yunsup Lee, Rimas Aviˇzienis, David Patterson, Krste Asanovi ́c.
Creative Commons Attribution 4.0 International License.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributors"><a class="anchor" href="#contributors"></a>Contributors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The contributor to RISC-V PLIC specification in alphabetical order:<br></p>
</div>
<div class="paragraph">
<p>Abner Chang &lt;<a href="mailto:abner.chang@hpe.com">abner.chang@hpe.com</a>&gt;<br>
Andrew Waterman &lt;<a href="mailto:andrew@sifive.com">andrew@sifive.com</a>&gt;<br>
Bin Meng &lt;<a href="mailto:bmeng.cn@gmail.com">bmeng.cn@gmail.com</a>&gt;<br>
Drew Barbier &lt;<a href="mailto:drew@sifive.com">drew@sifive.com</a>&gt;<br>
Jeff Scheel &lt;<a href="mailto:jeff@riscv.org">jeff@riscv.org</a>&gt;<br>
Jessica Clarke &lt;<a href="mailto:jrtc27@jrtc27.com">jrtc27@jrtc27.com</a>&gt;<br>
Jinyan Xu &lt;<a href="mailto:phantom@zju.edu.cn">phantom@zju.edu.cn</a>&gt;<br>
Krste Asanovic &lt;<a href="mailto:krste@sifive.com">krste@sifive.com</a>&gt;<br>
Palmer Dabbelt &lt;<a href="mailto:palmer@dabbelt.com">palmer@dabbelt.com</a>&gt;<br>
Robert Balas &lt;<a href="mailto:balasr@iis.ee.ethz.ch">balasr@iis.ee.ethz.ch</a>&gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification delineates the operation parameters according the general PLIC
architecture defined in the RISC-V platform-level interrupt controller (PLIC)
specification (was removed from <a href="https://github.com/riscv/riscv-isa-manual/releases/download/draft-20181201-5449851/riscv-privileged.pdf">RISC-V Privileged Spec v1.11-draft</a>)
to work in the context of RISC-V systems.<br>
The PLIC multiplexes various device interrupts onto the external interrupt lines
of Hart contexts, with hardware support for interrupt priorities. PLIC supports
up-to 1023 interrupts (0 is reserved) and 15872 contexts, but the actual number of
interrupts and context depends on the PLIC implementation. However, the implementation
must adhere to the offset of each register within the PLIC operation parameters.
The PLIC which claimed as PLIC-Compliant standard PLIC should follow the
implementations mentioned in sections below.</p>
</div>
<div class="sect2">
<h3 id="interrupt-targets-and-hart-contexts"><a class="anchor" href="#interrupt-targets-and-hart-contexts"></a>1.1. Interrupt Targets and Hart Contexts</h3>
<div class="paragraph">
<p>Interrupt targets are usually hart contexts, where a hart context is a given
privilege mode on a given hart (though there are other possible interrupt targets,
such as DMA engines). For example, in an 4-core system with 2-way SMT, you have 8
harts and probably at least two privilege modes per hart: machine mode and
supervisor mode (<a href="https://github.com/torvalds/linux/blob/5bfc75d92efd494db37f5c4c173d3639d4772966/Documentation/devicetree/bindings/interrupt-controller/sifive%2Cplic-1.0.0.yaml">Ref</a>).<br>
Not all hart contexts need be interrupt targets, in
particular, if a processor core does not support delegating external interrupts to
lower-privilege modes, then the lower-privilege hart contexts will not be interrupt
targets. Interrupt notifications generated by the PLIC appear in the meip/seip bits
of the mip/sip registers for M/S modes respectively.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Previous versions of this specification indicated that the PLIC
supports U-mode interrupts.  This text was removed because the
privileged architecture does not define U-mode interrupts.  If a
future privileged architecture specifies U-mode interrupts, this PLIC
specification can be straightforwardly extended to support them.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The notification only appear in lower-privilege xip registers if external interrupts
have been delegated to the lower-privilege modes.<br>
Each processor core must define a
policy on how simultaneous active interrupts are taken by multiple hart contexts
on the core. For the simple case of a single stack of hart contexts, one for each
supported privileged mode, interrupts for higher-privilege contexts can preempt
execution of interrupt handlers for lower-privilege contexts. A multithreaded
processor core could run multiple independent interrupt handlers on different hart
contexts at the same time. A processor core could also provide hart contexts that
are only used for interrupt handling to reduce interrupt service latency, and
these might preempt interrupt handlers for other harts on the same core.<br>
The PLIC treats each interrupt target independently and does not take into account
any interrupt prioritization scheme used by a component that contains multiple
interrupt targets. As a result, the PLIC provides no concept of interrupt
preemption or nesting so this must be handled by the cores hosting multiple
interrupt target contexts.</p>
</div>
<div class="paragraph">
<div class="title">RISC-V PLIC Interrupt Architecture Block Diagram</div>
<p><span class="image"><img src="_images/PLIC.jpg" alt="400" width="432"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="interrupt-gateways"><a class="anchor" href="#interrupt-gateways"></a>1.2. Interrupt Gateways</h3>
<div class="paragraph">
<p>The interrupt gateways are responsible for converting global interrupt signals
into a common interrupt request format, and for controlling the flow of interrupt
requests to the PLIC core. At most one interrupt request per interrupt source can
be pending in the PLIC core at any time, indicated by setting the source&#8217;s IP bit.
The gateway only forwards a new interrupt request to the PLIC core after receiving
notification that the interrupt handler servicing the previous interrupt request
from the same source has completed.<br>
If the global interrupt source uses level-sensitive interrupts, the gateway will
convert the first assertion of the interrupt level into an interrupt request, but
thereafter the gateway will not forward an additional interrupt request until it
receives an interrupt completion message. On receiving an interrupt completion
message, if the interrupt is level-triggered and the interrupt is still asserted, a
new interrupt request will be forwarded to the PLIC core. The gateway does not
have the facility to retract an interrupt request once forwarded to the PLIC core.
If a level-sensitive interrupt source deasserts the interrupt after the PLIC core
accepts the request and before the interrupt is serviced, the interrupt request
remains present in the IP bit of the PLIC core and will be serviced by a handler,
which will then have to determine that the interrupt device no longer requires
service.<br>
If the global interrupt source was edge-triggered, the gateway will convert the
first matching signal edge into an interrupt request. Depending on the design of
the device and the interrupt handler, in between sending an interrupt request and
receiving notice of its handler&#8217;s completion, the gateway might either ignore
additional matching edges or increment a counter of pending interrupts. In either
case, the next interrupt request will not be forwarded to the PLIC core until the
previous completion message has been received. If the gateway has a pending
interrupt counter, the counter will be decremented when the interrupt request is
accepted by the PLIC core. Unlike dedicated-wire interrupt signals,
message-signalled interrupts (MSIs) are sent over the system interconnect via a
message packet that describes which interrupt is being asserted. The message
is decoded to select an interrupt gateway, and the relevant gateway then handles
the MSI similar to an edge-triggered interrupt.</p>
</div>
</div>
<div class="sect2">
<h3 id="interrupt-notifications"><a class="anchor" href="#interrupt-notifications"></a>1.3. Interrupt Notifications</h3>
<div class="paragraph">
<p>Each interrupt target has an external interrupt pending (EIP) bit in the PLIC core
that indicates that the corresponding target has a pending interrupt waiting for
service. The value in EIP can change as a result of changes to state in the PLIC
core, brought on by interrupt sources, interrupt targets, or other agents
manipulating register values in the PLIC. The value in EIP is communicated
to the destination target as an interrupt notification. If the target is a RISC-V
hart context, the interrupt notifications arrive on the meip/seip bits
depending on the privilege level of the hart context.<br>
(<em>In simple systems, the
interrupt notifications will be simple wires connected to the processor
implementing a hart. In more complex platforms, the notifications might be routed
as messages across a system interconnect.</em>)<br></p>
</div>
<div class="paragraph">
<p>The PLIC hardware only supports multicasting of interrupts, such that all enabled
targets will receive interrupt notifications for a given active interrupt.<br>
(<em>Multicasting provides rapid response since the fastest responder claims the
interrupt, but can be wasteful in high-interrupt-rate scenarios if multiple harts
take a trap for an interrupt that only one can successfully claim. Software can
modulate the PLIC IE bits as part of each interrupt handler to provide alternate
policies, such as interrupt affinity or round-robin unicasting.</em>)<br></p>
</div>
<div class="paragraph">
<p>Depending on the platform architecture and the method used to transport interrupt
notifications, these might take some time to be received at the targets. The PLIC
is guaranteed to eventually deliver all state changes in EIP to all targets,
provided there is no intervening activity in the PLIC core.<br>
(<em>The value in an interrupt notification is only guaranteed to hold an EIP value
that was valid at some point in the past. In particular, a second target can
respond and claim an interrupt while a notification to the first target is still in
flight, such that when the first target tries to claim the interrupt it finds it has
no active interrupts in the PLIC core.</em>)</p>
</div>
</div>
<div class="sect2">
<h3 id="interrupt-identifiers-ids"><a class="anchor" href="#interrupt-identifiers-ids"></a>1.4. Interrupt Identifiers (IDs)</h3>
<div class="paragraph">
<p>Global interrupt sources are assigned small unsigned integer identifiers, beginning
at the value 1. An interrupt ID of 0 is reserved to mean “no interrupt”.<br>
Interrupt identifiers are also used to break ties when two or more interrupt
sources have the same assigned priority. Smaller values of interrupt ID take precedence over larger values of interrupt ID.</p>
</div>
</div>
<div class="sect2">
<h3 id="interrupt-flow"><a class="anchor" href="#interrupt-flow"></a>1.5. Interrupt Flow</h3>
<div class="paragraph">
<p>Below figure shows the messages flowing between agents when handling interrupts
via the PLIC.<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Global interrupts are sent from their source to an interrupt gateway that
processes the interrupt signal from each source</p>
</li>
<li>
<p>Interrupt gateway then sends a single interrupt request to the PLIC core, which
latches these in the core interrupt pending bits (IP).</p>
</li>
<li>
<p>The PLIC core forwards an interrupt notification to one or more targets if
the targets have any pending interrupts enabled, and the priority of the pending
interrupts exceeds a per-target threshold.</p>
</li>
<li>
<p>When the target takes the external interrupt, it sends an interrupt claim
request to retrieve the identifier of the highest priority global interrupt
source pending for that target from the PLIC core.</p>
</li>
<li>
<p>PLIC core then clears the corresponding interrupt source pending bit.</p>
</li>
<li>
<p>After the target has serviced the interrupt, it sends the associated interrupt
gateway an interrupt completion message</p>
</li>
<li>
<p>The interrupt gateway can now forward another interrupt request for the same
source to the PLIC.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">PLIC Interrupt Flow</div>
<p><span class="image"><img src="_images/PLICInterruptFlow.jpg" alt="PLICInterruptFlow"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="risc-v-plic-operation-parameters"><a class="anchor" href="#risc-v-plic-operation-parameters"></a>2. RISC-V PLIC Operation Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>General PLIC operation parameter register blocks are defined in this spec, those are:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Interrupt Priorities registers:</strong><br>
The interrupt priority for each interrupt source.<br></p>
</li>
<li>
<p><strong>Interrupt Pending Bits registers:</strong><br>
The interrupt pending status of each interrupt source.<br></p>
</li>
<li>
<p><strong>Interrupt Enables registers:</strong><br>
The enablement of interrupt source of each context.<br></p>
</li>
<li>
<p><strong>Priority Thresholds registers:</strong><br>
The interrupt priority threshold of each context.<br></p>
</li>
<li>
<p><strong>Interrupt Claim registers:</strong><br>
The register to acquire interrupt source ID of each context.<br></p>
</li>
<li>
<p><strong>Interrupt Completion registers:</strong><br>
The register to send interrupt completion message to the associated gateway.<br></p>
<div class="paragraph">
<p>Below is the figure of PLIC Operation Parameter Block Diagram,</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">PLIC Operation Parameter Block Diagram</div>
<p><span class="image"><img src="_images/PLICArch.jpg" alt="PLICArch"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="memory-map"><a class="anchor" href="#memory-map"></a>3. Memory Map</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>base address of PLIC Memory Map</code> is platform implementation-specific. The memory-mapped
registers specified in this chapter have a width of 32-bits. The bits are accessed atomically with LW and SW instructions.</p>
</div>
<div class="paragraph">
<p><strong>PLIC Memory Map</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>base + 0x000000: Reserved (interrupt source 0 does not exist)
base + 0x000004: Interrupt source 1 priority
base + 0x000008: Interrupt source 2 priority
...
base + 0x000FFC: Interrupt source 1023 priority
base + 0x001000: Interrupt Pending bit 0-31
base + 0x00107C: Interrupt Pending bit 992-1023
...
base + 0x002000: Enable bits for sources 0-31 on context 0
base + 0x002004: Enable bits for sources 32-63 on context 0
...
base + 0x00207C: Enable bits for sources 992-1023 on context 0
base + 0x002080: Enable bits for sources 0-31 on context 1
base + 0x002084: Enable bits for sources 32-63 on context 1
...
base + 0x0020FC: Enable bits for sources 992-1023 on context 1
base + 0x002100: Enable bits for sources 0-31 on context 2
base + 0x002104: Enable bits for sources 32-63 on context 2
...
base + 0x00217C: Enable bits for sources 992-1023 on context 2
...
base + 0x1F1F80: Enable bits for sources 0-31 on context 15871
base + 0x1F1F84: Enable bits for sources 32-63 on context 15871
base + 0x1F1FFC: Enable bits for sources 992-1023 on context 15871
...
base + 0x1FFFFC: Reserved
base + 0x200000: Priority threshold for context 0
base + 0x200004: Claim/complete for context 0
base + 0x200008: Reserved
...
base + 0x200FFC: Reserved
base + 0x201000: Priority threshold for context 1
base + 0x201004: Claim/complete for context 1
...
base + 0x3FFF000: Priority threshold for context 15871
base + 0x3FFF004: Claim/complete for context 15871
base + 0x3FFF008: Reserved
...
base + 0x3FFFFFC: Reserved</pre>
</div>
</div>
<div class="paragraph">
<p>Sections below describe the control register blocks of PLIC operation parameters.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interrupt-priorities"><a class="anchor" href="#interrupt-priorities"></a>4. Interrupt Priorities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Interrupt priorities are small unsigned integers, with a platform-specific maximum
number of supported levels. The priority value 0 is reserved to mean "never
interrupt", and interrupt priority increases with increasing integer values.
Each global interrupt source has an associated interrupt priority held in a
memory-mapped register. Different interrupt sources need not support the same set
of priority values. A valid implementation can hardwire all input priority levels.
Interrupt source priority registers should be WARL fields to allow software to
determine the number and position of read-write bits in each priority
specification, if any. To simplify discovery of supported priority values, each
priority register must support any combination of values in the bits that are
variable within the register, i.e., if there are two variable bits in the
register, all four combinations of values in those bits must operate as valid priority levels.</p>
</div>
<div class="paragraph">
<p>If PLIC supports Interrupt Priorities, then each PLIC interrupt source can be
assigned a priority by writing to its 32-bit memory-mapped <code>priority</code> register.  A
priority value of 0 is reserved to mean "never interrupt" and effectively disables
the interrupt. Priority 1 is the lowest active priority while the maximum level of priority depends on PLIC implementation. Ties between global interrupts of the
same priority are broken by the Interrupt ID; interrupts with the lowest ID have
the highest effective priority.<br>
<br>
The base address of Interrupt Source Priority block within PLIC Memory Map region is fixed at 0x000000.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Source Priority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Source Priority #0 to #1023</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024 * 4 = 4096(0x1000) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a continuously memory block which contains PLIC Interrupt Source Priority. Total 1024 Interrupt Source Priority
in this memory block. Interrupt Source Priority #0 is reserved which indicates it does not exist.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Source Priority Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x000000: Reserved (interrupt source 0 does not exist)
0x000004: Interrupt source 1 priority
0x000008: Interrupt source 2 priority
...
0x000FFC: Interrupt source 1023 priority</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interrupt-pending-bits"><a class="anchor" href="#interrupt-pending-bits"></a>5. Interrupt Pending Bits</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The current status of the interrupt source pending bits in the PLIC core can be
read from the pending array, organized as 32-bit register.  The pending bit
for interrupt ID N is stored in bit (N mod 32) of word (N/32).  Bit 0
of word 0, which represents the non-existent interrupt source 0, is hardwired
to zero.</p>
</div>
<div class="paragraph">
<p>A pending bit in the PLIC core can be cleared by setting the associated enable
bit then performing a claim.<br>
<br>
The base address of Interrupt Pending Bits block within PLIC Memory Map region is fixed at 0x001000.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Pending Bits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Pending Bit of Interrupt Source #0 to #N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024 / 8 = 128(0x80) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a continuously memory block contains PLIC Interrupt Pending Bits. Each
Interrupt Pending Bit occupies 1-bit from this register block.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Pending Bits Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x001000: Interrupt Source #0 to #31 Pending Bits
...
0x00107C: Interrupt Source #992 to #1023 Pending Bits</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interrupt-enables"><a class="anchor" href="#interrupt-enables"></a>6. Interrupt Enables</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each global interrupt can be enabled by setting the corresponding bit in the
<code>enables</code> register. The <code>enables</code> registers are accessed as a contiguous array
of 32-bit registers, packed the same way as the <code>pending</code> bits. Bit 0 of enable
register 0 represents the non-existent interrupt ID 0 and is hardwired to 0.
PLIC has 15872 Interrupt Enable blocks for the contexts.<br>
How PLIC organizes interrupts for the contexts (Hart and privilege mode)
is out of RISC-V PLIC specification scope, however it must be spec-out in vendor&#8217;s
PLIC specification.<br>
(<em>A large number of potential IE bits might be hardwired to zero in cases where
some interrupt sources can only be routed to a subset of targets. A larger number
of bits might be wired to 1 for an embedded device with fixed interrupt routing.
Interrupt priorities, thresholds, and hart-internal interrupt masking provide
considerable flexibility in ignoring external interrupts even if a global interrupt
source is always enabled.</em>)<br>
<br>
The base address of Interrupt Enable Bits block within PLIC Memory Map region is
fixed at 0x002000.<br></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Enable Bits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Enable Bit of Interrupt Source #0 to #1023 for 15872 contexts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1024 / 8) * 15872 = 2031616(0x1f0000) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a continuously memory block contains PLIC Interrupt Enable Bits of 15872 contexts.
Each Interrupt Enable Bit occupies 1-bit from this register block and total 15872 Interrupt
Enable Bit blocks</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Enable Bits Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x002000: Interrupt Source #0 to #31 Enable Bits on context 0
...
0x00207C: Interrupt Source #992 to #1023 Enable Bits on context 0
0x002080: Interrupt Source #0 to #31 Enable Bits on context 1
...
0x0020FC: Interrupt Source #992 to #1023 Enable Bits on context 1
0x002100: Interrupt Source #0 to #31 Enable Bits on context 2
...
0x00217C: Interrupt Source #992 to #1023 Enable Bits on context 2
0x002180: Interrupt Source #0 to #31 Enable Bits on context 3
...
0x0021FC: Interrupt Source #992 to #1023 Enable Bits on context 3
...
...
...
0x1F1F80: Interrupt Source #0 to #31 on context 15871
...
0x1F1FFC: Interrupt Source #992 to #1023 on context 15871</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="priority-thresholds"><a class="anchor" href="#priority-thresholds"></a>7. Priority Thresholds</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PLIC provides context based <code>threshold register</code> for the settings of a interrupt priority
threshold of each context. The <code>threshold register</code> is a WARL field. The PLIC will mask all
PLIC interrupts of a priority less than or equal to <code>threshold</code>.  For example,
a <code>threshold</code> value of zero permits all interrupts with non-zero priority.<br>
<br>
The base address of Priority Thresholds register block is located at 4K alignment starts
from offset 0x200000.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Priority Threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Priority Threshold for 15872 contexts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096 * 15872 = 65011712(0x3e00000) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the register of Priority Thresholds setting for each context</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Priority Thresholds Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x200000: Priority threshold for context 0
0x201000: Priority threshold for context 1
0x202000: Priority threshold for context 2
0x203000: Priority threshold for context 3
...
...
...
0x3FFF000: Priority threshold for context 15871</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interrupt-claim-process"><a class="anchor" href="#interrupt-claim-process"></a>8. Interrupt Claim Process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometime after a target receives an interrupt notification, it might decide to
service the interrupt. The target sends an interrupt claim message to the PLIC
core, which will usually be implemented as a non-idempotent memory-mapped I/O
control register read. On receiving a claim message, the PLIC core will atomically
determine the ID of the highest-priority pending interrupt for the target
and then clear down the corresponding source’s IP bit. The PLIC core will then
return the ID to the target. The PLIC core will return an ID of zero, if there
were no pending interrupts for the target when the claim was serviced.<br>
After the highest-priority pending interrupt is claimed by a target and the
corresponding IP bit is cleared, other lower-priority pending interrupts might
then become visible to the target, and so the PLIC EIP bit might not be cleared
after a claim. The interrupt handler can check the local meip/seip/ueip bits
before exiting the handler, to allow more efficient service of other interrupts
without first restoring the interrupted context and taking another interrupt trap.<br>
It is always legal for a hart to perform a claim even if the EIP is not set. In
particular, a hart could set the threshold value to maximum to disable interrupt
notifications and instead poll for active interrupts using periodic claim requests,
though a simpler approach to implement polling would be to clear the external
interrupt enable in the corresponding xie register for privilege mode x.<br></p>
</div>
<div class="paragraph">
<p>The PLIC can perform an interrupt claim by reading the <code>claim/complete</code>
register, which returns the ID of the highest priority pending interrupt or
zero if there is no pending interrupt.  A successful claim will also atomically
clear the corresponding pending bit on the interrupt source. The PLIC can perform a claim at any time and the claim operation is not affected
by the setting of the priority threshold register.<br>
<br>
The Interrupt Claim Process register is context based and is located at
(4K alignment + 4) starts from offset 0x200000.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Claim Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Claim Process for 15872 contexts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096 * 15872 = 65011712(0x3e00000) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the register used to acquire interrupt ID for each context</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Claim Process Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x200004: Interrupt Claim Process for context 0
0x201004: Interrupt Claim Process for context 1
0x202004: Interrupt Claim Process for context 2
0x203004: Interrupt Claim Process for context 3
...
...
...
0x3FFF004: Interrupt Claim Process for context 15871</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interrupt-completion"><a class="anchor" href="#interrupt-completion"></a>9. Interrupt Completion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The PLIC signals it has completed executing an interrupt handler by writing the
interrupt ID it received from the claim to the <code>claim/complete</code> register.  The
PLIC does not check whether the completion ID is the same as the last claim ID
for that target.  If the completion ID does not match an interrupt source that
is currently enabled for the target, the completion is silently ignored.<br>
After a handler has completed service of an interrupt, the associated gateway
must be sent an interrupt completion message, usually as a write to a
non-idempotent memory-mapped I/O control register. The gateway will only forward
additional interrupts to the PLIC core after receiving the completion message.<br>
<br>
The Interrupt Completion registers are context based and located at the same address
with Interrupt Claim Process register, which is at (4K alignment + 4) starts from
offset 0x200000.
<br></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PLIC Register Block Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Registers</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Register Block Size in Byte</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Completion Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interrupt Completion  for 15872 contexts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096 * 15872 = 65011712(0x3e00000) bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is register to write to complete Interrupt process</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>PLIC Interrupt Completion Memory Map</strong><br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>0x200004: Interrupt Completion for context 0
0x201004: Interrupt Completion for context 1
0x202004: Interrupt Completion for context 2
0x203004: Interrupt Completion for context 3
...
...
...
0x3FFF004: Interrupt Completion for context 15871</pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="introduction.html">Introduction</a></span>
</nav>
</article>  </div>
</main>
<div class="modal micromodal-slide" id="modal-versions" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true">
            <main class="modal__content" id="modal-versions-content">
              <button data-micromodal-close class="modal-versions-close">
                <svg width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><defs><style>.cls-1h{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1h" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1h" x1="7" x2="25" y1="25" y2="7"/></g></svg>
              </button>
                  <ul class="nav-versions">
                      <li class="component">
                        <div>
                          <a class="title" href="../../ffh/v1.0/index.html">ACPI Functional Fixed Hardware</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../ffh/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../aia/v1.0/index.html">Advanced Interrupt Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../aia/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../etrace/v1.0/index.html">E-Trace Encapsulation Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../etrace/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../psabi/v1.0/index.html">ELF psABI Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../psabi/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../iommuArch/v1.0/index.html">IOMMU Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../iommuArch/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../isa/index.html">ISA Specifications</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../isa/index.html">
      default
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../reri/v1.0/index.html">RERI Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../reri/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../qos/v1.0/index.html">RISC-V Capacity and Bandwidth QoS Register Interface</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../qos/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="index.html">RISC-V Platform-Level Interrupt Controller</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="index.html">
      v1.0.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../semihost/v1.0/index.html">semihosting</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../semihost/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                  </ul>
            </main>
        </div>
    </div>
</div>

</div>
<footer class="hidden">
</footer><script src="../../_/js/vendor/import.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/spring-tabs.js" data-sync-storage-key="docs:preferred-tab"></script>
  </body>
</html>
