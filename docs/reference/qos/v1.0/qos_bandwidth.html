<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: RISC-V Ratified Specifications Library</title>
    <link rel="prev" href="qos_capacity.html">
    <link rel="next" href="qos_iommu.html">
    <meta name="generator" content="Antora 3.1.12">
    <script>
!function (theme, navWidth) {
  if (theme === 'dark') document.documentElement.classList.add('dark-theme')
  if (navWidth) document.documentElement.style.setProperty('--nav-width', `${navWidth}px`)
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'),
  localStorage && localStorage.getItem('nav-width'))
    </script>
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/search.css">
    <link rel="stylesheet" href="../../_/css/vendor/page-search.css">
    <link rel="stylesheet" href="../../_/css/vendor/spring-tabs.css">

    <meta name="antora-ui-version" content="3f4ce2c51445edcfc62ee1f59ab97fffc218fb79"> 
    <meta name="version" content="v1.0">
    <meta name="component" content="qos">
    <meta name="latest-version" content="false">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body class="article">
<link rel="stylesheet" type="text/css" href="/docs/reference/_/docusaurus-styles-copy-08-25.css">

<header class="header" id="antora-header">
    <nav class="navbar">
        <head>
            <link data-rh="true" rel="icon" href="/img/favicon.ico">
            <link data-rh="true" rel="canonical" href="https://developer.riscv.org/ref">
            <link data-rh="true" rel="alternate" href="https://developer.riscv.org/ref" hreflang="en">
            <link data-rh="true" rel="alternate" href="https://developer.riscv.org/ref" hreflang="x-default">
            <link data-rh="true" rel="preconnect" href="https://MGVPU7BN22-dsn.algolia.net" crossorigin="anonymous">
            <link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RISC-V Developer Portal RSS Feed">
            <link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RISC-V Developer Portal Atom Feed">

            <link rel="search" type="application/opensearchdescription+xml" title="RISC-V Developer Portal" href="/opensearch.xml">
            <link rel="stylesheet" href="/assets/css/styles.2a6e33aa.css">
            <script src="/assets/js/runtime~main.1f8bbb5b.js" defer="defer"></script>
            <script src="/assets/js/main.0e5d05c8.js" defer="defer"></script>
        </head>
        <script>
            !function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())
        </script>
            <link rel="preload" as="image" href="/img/logo.svg">
            <div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div>
            <div class="announcementBar_mb4j" role="banner">
                <div class="announcementBarPlaceholder_vyr4"></div>
                <div class="content_knG7 announcementBarContent_xLdY">congratulations, you found the RISC-V Developer Portal! ðŸŽ‰ . This site is under active development and not meant for public consumption yet.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div>
            <nav aria-label="Main" class="navbar ">
                <div class="navbar__inner">
                    <div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button>
                        <a class="navbar__brand" href="/">
                            <div class="navbar__logo"><img src="/img/logo.svg" alt="RISC-V Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="RISC-V Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a>
                        <div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Specifications</a>
                            <ul class="dropdown__menu">
                                <li><a class="dropdown__link" href="/docs/spec/isa">ISA</a></li>
                                <li><a class="dropdown__link" href="/docs/spec/profiles">Profiles</a></li>
                                <li><a class="dropdown__link" docid="spec/non-isa" href="/docs/spec/non-isa">Non-ISA</a></li>
                            </ul>
                        </div>
                        <div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developers</a>
                            <ul class="dropdown__menu">
                                <li><a class="dropdown__link" href="/docs/spec/intro">Specification Developers</a></li>
                                <li><a class="dropdown__link" href="/docs/hardware/overview">Hardware Developers</a></li>
                                <li><a class="dropdown__link" href="/docs/software/overview">Software Developers</a></li>
                            </ul>
                        </div><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://riscv.org/community/calendar/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div>
                    <div class="navbar__items navbar__items--right">
                        <div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div>
                        <div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div>
                    </div>
                </div>
                <div role="presentation" class="navbar-sidebar__backdrop"></div>
            </nav>
            <div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper__tJE"></div>
        

    </nav>
</header><div class="body">
<div class="nav-container" data-component="qos" data-version="v1.0">
  <aside class="nav">
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
        <nav class="nav-menu">
<div class="context">
  <span class="title">RISC-V Capacity and Bandwidth QoS Register Interface</span>
  <span class="version">v1.0</span>
  <button class="browse-version" id="browse-version">
    <svg
      height="24px"
      id="Layer_1"
      style="enable-background:new 0 0 512 512;"
      version="1.1"
      viewBox="0 0 512 512"
      width="24px"
      xml:space="preserve"
    ><g><path
          d="M256,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S273.7,224,256,224L256,224z"
        ></path><path
          d="M128.4,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S146,224,128.4,224L128.4,224z"
        ></path><path
          d="M384,224c-17.7,0-32,14.3-32,32s14.3,32,32,32s32-14.3,32-32S401.7,224,384,224L384,224z"
        ></path></g></svg>
  </button>
  </div><ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">RISC-V Capacity and Bandwidth Controller QoS Register Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_contributors.html">Contributors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_identifiers.html">QoS Identifiers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_capacity.html">Capacity-controller QoS Register Interface</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link"  href="qos_bandwidth.html">Bandwidth-controller QoS Register Interface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_iommu.html">IOMMU Extension for QoS ID</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_hw_guidelines.html">Hardware Guidelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="qos_sw_guidelines.html">Software Guidelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="https://github.com/riscv-non-isa/riscv-cbqri/releases/download/v1.0/riscv-cbqri.pdf">Download PDF</a>
  </li>
</ul>
  </li>
</ul>
          <div class="toggle-sm">
            <button id="nav-toggle-2" class="nav-toggle"></button>
          </div>
        </nav>
      </div>
      <div class="nav-collapse">
        <button id="nav-collapse-toggle"><span></span></button>        
      </div>
    </div>
    <div class="nav-resize"></div>
  </aside>
</div>
<script>
!function (sidebar) {
  if (sidebar) {
    document.body.classList.add('nav-sm')
  }
}(localStorage && localStorage.getItem('sidebar') === 'close')
</script><main class="article">
<div class="toolbar" role="navigation">
  <button id="nav-toggle-1" class="nav-toggle"></button>
</div>
  <div class="content">
<aside class="sidebar">
  <div class="content">
    <div
      class="toc"
      data-title=""
      data-levels="2"
    >
      <div class="toc-menu"></div>
    </div>
    <div class="sidebar-links">
        <a href="https://github.com/riscv-non-isa/riscv-cbqri/edit/antora-refactor/modules/ROOT/pages/qos_bandwidth.adoc">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            viewBox="0 0 24 24"
            width="24"
          ><path
              d="m16 2.012 3 3L16.713 7.3l-3-3zM4 14v3h3l8.299-8.287-3-3zm0 6h16v2H4z"
            ></path></svg>
          Edit this Page
        </a>
              <a href="https://github.com/riscv-non-isa/riscv-cbqri" title="GitHub">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          GitHub Project
        </a>

      <a href="" title="PDF">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          Download PDF
        </a>
    </div>
  </div>
</aside>
<article class="doc">
<div class="breadcrumbs-container">
  <nav class="breadcrumbs" aria-label="breadcrumbs">
    <ul>
      <li><a href="index.html">RISC-V Capacity and Bandwidth QoS Register Interface</a></li>
      <li>RISC-V Capacity and Bandwidth Controller QoS Register Interface</li>
      <li><a href="qos_bandwidth.html">Bandwidth-controller QoS Register Interface</a></li>
    </ul>
  </nav>
</div><div class="sect1">
<h2 id="BC_QOS"><a class="anchor" href="#BC_QOS"></a>Bandwidth-controller QoS Register Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Controllers, such as memory controllers, that support bandwidth allocation and
bandwidth usage monitoring provide a memory-mapped bandwidth-controller QoS
register interface.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Bandwidth-controller QoS Register Layout (size and offset are in bytes)</caption>
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 25.641%;">
<col style="width: 7.6923%;">
<col style="width: 46.1538%;">
<col style="width: 12.8206%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-center valign-top">Size</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Optional?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bc_capabilities</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#BC_CAP">Capabilities</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bc_mon_ctl</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#BC_MCTL">Usage monitoring
                                      control</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bc_mon_ctr_val</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#BC_MCTR">Monitoring
                                      counter value</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bc_alloc_ctl</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#BC_ALLOC">Bandwidth
                                    allocation control</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bc_bw_alloc</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#BC_BMASK">Bandwidth
                                    allocation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The reset value is 0 for the following register fields.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bc_mon_ctl.BUSY</code> field</p>
</li>
<li>
<p><code>bc_alloc_ctl.BUSY</code> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reset value is <code>UNSPECIFIED</code> for all other register fields.</p>
</div>
<div class="paragraph">
<p>The bandwidth controllers at reset must allocate all available bandwidth to
<code>RCID</code> value of 0. When the bandwidth controller supports bandwidth allocation
per access-type, the access-type value of 0 of <code>RCID=0</code> is allocated all
available bandwidth, while all other access-types associated with that <code>RCID</code>
share the bandwidth allocation with <code>AT=0</code>. The bandwidth allocation for all
other <code>RCID</code> values is <code>UNSPECIFIED</code>. The bandwidth controller behavior in
handling a request with a non-zero <code>RCID</code> value before configuring the bandwidth
controller with bandwidth allocation for that <code>RCID</code> is also <code>UNSPECIFIED</code>.</p>
</div>
<div class="sect2">
<h3 id="BC_CAP"><a class="anchor" href="#BC_CAP"></a>Bandwidth-controller Capabilities</h3>
<div class="paragraph">
<p>The <code>bc_capabilities</code> register is a read-only register that holds the
bandwidth-controller capabilities.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/wavedrom/svg/eNqrLkpNt1KI5lJQqE7KLCm2UlCw0FHIS8xNtVJQD3MNUq_VQUgZmsGl_JzCnXy8g1GkFQzh0kEBbhGociZwuQBUCWO4RHhAkCcu-3yDgBbikoRpjNVRSM7PS8tMt6rOScxLBSoC2ppRXJCYnGplaGBkUlsLANcGQyU=" alt="Bandwidth-controller Capabilities Register">
</div>
<div class="title">Figure 1. Bandwidth-controller Capabilities Register</div>
</div>
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p>The <code>VER</code> field holds the version of the specification implemented by the
bandwidth controller. The low nibble is used to hold the minor version of the
specification and the upper nibble is used to hold the major version of the
specification. For example, an implementation that supports version 1.0 of the
specification reports <code>0x10</code>.</p>
</div>
<div class="paragraph">
<p>The <code>NBWBLKS</code> field holds the total number of available bandwidth blocks in
the controller. The bandwidth represented by each bandwidth block is
<code>UNSPECIFIED</code>. The bandwidth controller supports reserving bandwidth in
multiples of a bandwidth block, which enables proportional allocation of
bandwidth.</p>
</div>
<div class="paragraph">
<p>Bandwidth controllers can limit the maximum bandwidth that can be reserved to
a value smaller than the <code>NBWBLKS</code> value. The <code>MRBWB</code> field reports the maximum number of
bandwidth blocks that can be reserved.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The bandwidth controller meters the bandwidth usage by a workload to
determine if it is exceeding its allocations and, if necessary, take
measures to throttle the workload&#8217;s bandwidth usage. Therefore, the instantaneous
bandwidth used by a workload either exceeds or falls short of the configured
allocation. QoS capabilities are statistical in nature and are typically
designed to enforce the configured bandwidth over larger time windows. By not
allowing all available bandwidth blocks to be reserved for allocation, the
bandwidth controller can handle such transient inaccuracies.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the <code>RCID</code>-prefixed mode (<code>RPFX</code>) is 1, the controller operates in <code>RPFX</code>
mode. The parameter <code>P</code> (prefixed bits) indicates the number of least significant
bits of the <code>MCID</code> carried in the request that should be prefixed by the RCID. The
controller uses <code>RCID</code> in the requests along with <code>P</code> number of least significant
bits of the <code>MCID</code> to compute an effective <code>MCID</code> (<a href="#EMCID">[EMCID]</a>). This <code>MCID</code> is used
to identify the monitoring counter. Legal values of <code>P</code> range from 0 to 12.</p>
</div>
<div class="paragraph">
<p>If <code>RPFX</code> is 0, <code>P</code> is set to 0, and the effective <code>MCID</code> is the same as the <code>MCID</code>
in the request.</p>
</div>
</div>
<div class="sect2">
<h3 id="BC_MCTL"><a class="anchor" href="#BC_MCTL"></a>Bandwidth Usage Monitoring Control</h3>
<div class="paragraph">
<p>The <code>bc_mon_ctl</code> register controls the monitoring of bandwidth usage by a
<code>MCID</code>. When the controller does not support bandwidth usage monitoring, the
<code>bc_mon_ctl</code> register is read-only zero.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/wavedrom/svg/eNqrLkpNt1KI5lJQqE7KLCm2UlAw1VHIS8xNtVJQ9w9Qr9VBkjGGyziGoMgYGsFlfJ09XVB1WcDlXMNC4tFlDZHMDMNlXXhAkCeqnDlcLjjEMSQ0GJehTqHBkShyRiYYpsbqKCTn56VlpltV5yTmpYIU6ShkFBckJqdaGRoYmdTWAgBWNFIF" alt="Bandwidth Usage Monitoring Control Register (`bc_mon_ctl`)">
</div>
<div class="title">Figure 2. Bandwidth Usage Monitoring Control Register (<code>bc_mon_ctl</code>)</div>
</div>
<div class="paragraph">
<p>Bandwidth controllers that support bandwidth usage monitoring implement a usage
monitoring counter for each supported <code>MCID</code>. The usage monitoring counter might
be configured to count a monitoring event. When an event matching the event
configured for the <code>MCID</code> occurs, then the monitoring counter is updated. The
event matching can optionally be filtered by the access-type. The monitoring
counter for bandwidth usage counts the number of bytes transferred by requests
matching the monitoring event as the requests go past the monitoring point.</p>
</div>
<div class="paragraph">
<p>The <code>OP</code>, <code>AT</code>, <code>MCID</code>, and <code>EVT_ID</code> fields of the register are WARL fields.</p>
</div>
<div class="paragraph">
<p>The <code>OP</code> field is used to instruct the controller to perform an operation
listed in <a href="#BC_MON_OP">Bandwidth Usage Monitoring Operations (<code>OP</code>)</a>.</p>
</div>
<table id="BC_MON_OP" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Bandwidth Usage Monitoring Operations (<code>OP</code>)</caption>
<colgroup>
<col style="width: 16.3265%;">
<col style="width: 12.2448%;">
<col style="width: 71.4287%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operation</th>
<th class="tableblock halign-center valign-top">Encoding</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONFIG_EVENT</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the counter selected by <code>MCID</code> to count
                             the event selected by <code>EVT_ID</code>, <code>AT</code>, and <code>ATV</code>.
                             The <code>EVT_ID</code> encodings are listed in <a href="#BC_EVT_ID">Bandwidth Monitoring Event ID (<code>EVT_ID</code>)</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>READ_COUNTER</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Snapshot the value of the counter selected by
                             <code>MCID</code> into <code>bc_mon_ctr_val</code> register. The
                             <code>EVT_ID</code>, <code>AT</code>, and <code>ATV</code> fields are not used by
                             this operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3-23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">24-31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Designated for custom use.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>CONFIG_EVENT</code> operation uses the <code>EVT_ID</code> operand to program the identifier of the
event to count in the monitoring counter, selected by <code>MCID</code>.
The <code>AT</code> field is used to program the access-type to count, and its validity is
indicated by the <code>ATV</code> field. When <code>ATV</code> is 0, the counter counts requests with
all access-types, and the <code>AT</code> value is ignored.</p>
</div>
<table id="BC_EVT_ID" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Bandwidth Monitoring Event ID (<code>EVT_ID</code>)</caption>
<colgroup>
<col style="width: 37.5%;">
<col style="width: 12.5%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Event ID</th>
<th class="tableblock halign-center valign-top">Encoding</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter does not count.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Total Read
  and Write
  byte count</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter is incremented by the number of bytes
                             transferred by a matching read or write request
                             as the requests go past the monitor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Total Read
  byte count</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter is incremented by the number of bytes
                             transferred by a matching read request as the
                             requests go past the monitor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Total Write
  byte count</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter is incremented by the number of bytes
                             transferred by a matching write request as the
                             requests go past the monitor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4-127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">128-256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Designated for custom use.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When the <code>EVT_ID</code> for a <code>MCID</code> is programmed with a non-zero and legal value,
the counter is reset to 0 and starts counting matching events for requests with
the matching <code>MCID</code> and <code>AT</code> (if <code>ATV</code> is 1). However, if the <code>EVT_ID</code> is
configured as 0, the counter stops counting.</p>
</div>
<div class="paragraph">
<p>A controller that does not support monitoring by access-type can hardwire the
<code>ATV</code> and the <code>AT</code> fields to 0, indicating that the counter counts requests with
all access-types.</p>
</div>
<div class="paragraph">
<p>When the <code>bc_mon_ctl</code> register is written, the controller may need to perform
several actions that may not complete synchronously with the write. A write to
the <code>bc_mon_ctl</code> register sets the read-only <code>BUSY</code> bit to 1, indicating that the
controller is performing the requested operation. When the <code>BUSY</code> bit reads 0, the
operation is complete, and the read-only <code>STATUS</code> field provides a status value
(see <a href="#BC_MON_STS"><code>bc_mon_ctl.STATUS</code> Field Encodings</a> for details). Written values to the <code>BUSY</code> and the <code>STATUS</code>
fields are ignored. An implementation that can complete the operation
synchronously with the write may hardwire the <code>BUSY</code> bit to 0. The state of the
<code>BUSY</code> bit, when not hardwired to 0, shall only change in response to a write to
the register. The <code>STATUS</code> field remains valid until a subsequent write to the
<code>bc_mon_ctl</code> register.</p>
</div>
<table id="BC_MON_STS" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. <code>bc_mon_ctl.STATUS</code> Field Encodings</caption>
<colgroup>
<col style="width: 14.6341%;">
<col style="width: 85.3659%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>STATUS</code></th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation was successfully completed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An invalid operation (<code>OP</code>) was requested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation was requested for an invalid <code>MCID</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation was requested for an invalid <code>EVT_ID</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation was requested for an invalid <code>AT</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6-63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Designated for custom use.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When the <code>BUSY</code> bit is set to 1, the behavior of writes to the <code>bc_mon_ctl</code> is
<code>UNSPECIFIED</code>. Some implementations may ignore the second write, while others
may perform the operation determined by the second write. To ensure proper
operation, software must first verify that the <code>BUSY</code> bit is 0 before writing
the <code>bc_mon_ctl</code> register.</p>
</div>
</div>
<div class="sect2">
<h3 id="BC_MCTR"><a class="anchor" href="#BC_MCTR"></a>Bandwidth Monitoring Counter Value</h3>
<div class="paragraph">
<p>The <code>bc_mon_ctr_val</code> is a read-only register that holds a snapshot of the
counter selected by a <code>READ_COUNTER</code> operation. When the controller does not
support bandwidth usage monitoring, the <code>bc_mon_ctr_val</code> register always reads
as zero.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/wavedrom/svg/eNqrLkpNt1KI5lJQqE7KLCm2UlAwM9JRyEvMTbVSUHcOCVKv1UGSUzCEy3n6heGU8w9zA8nF6igk5-elZaZbVeck5qUCFQGNziguSExOtTI0MDKprQUAtS4j_w==" alt="Bandwidth Monitoring Counter Value Register (`bc_mon_ctr_val`)">
</div>
<div class="title">Figure 3. Bandwidth Monitoring Counter Value Register (<code>bc_mon_ctr_val</code>)</div>
</div>
<div class="paragraph">
<p>The counter is valid if the <code>INV</code> field is 0. The counter may be marked
<code>INV</code> if, for <code>UNSPECIFIED</code> reasons, the controller determines the count to be
not valid. Such counters may become valid in the future. Additionally, if an
unsigned integer overflow of the counter occurs, then the <code>OVF</code> bit is set to 1.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A counter may be marked as <code>INV</code> if the controller has not been able to
establish an accurate counter value for the monitored event.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The counter provides the number of bytes transferred by requests matching the
<code>EVT_ID</code> as they go past the monitoring point. A bandwidth value may be
determined by reading the byte count value at two instances of time <code>T1</code> and
<code>T2</code>. If the value of the counter at time <code>T1</code> was <code>B1</code>, and at time <code>T2</code> is
<code>B2</code>, then the bandwidth can be calculated using <a href="#eq-3">equation (1)</a>. The frequency of the
time source is represented by \(T_{freq}\).</p>
</div>
<div id="eq-3" class="stemblock">
<div class="content">
\[\begin{equation}
Bandwidth = T_{freq} \times \frac{ B2 - B1 }{T2 - T1}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>The width of the counter is <code>UNSPECIFIED</code> but the unimplemented bits must be
read-only zero.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While the width of the counter is <code>UNSPECIFIED</code>, it is recommended to be wide
enough to prevent more than one overflow per sample when the sampling frequency
is 1 Hz.</p>
</div>
<div class="paragraph">
<p>If an overflow was detected then software may discard that sample and reset the
counter and overflow indication by reprogramming the event using <code>CONFIG_EVENT</code>
operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="BC_ALLOC"><a class="anchor" href="#BC_ALLOC"></a>Bandwidth Allocation Control</h3>
<div class="paragraph">
<p>The <code>bc_alloc_ctl</code> register is used to control the allocation of bandwidth to an
<code>RCID</code> per <code>AT</code>. If a controller does not support bandwidth allocation, then the
register is read-only zero. If the controller does not support bandwidth
allocation per access-type, then the <code>AT</code> field is read-only zero.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/wavedrom/svg/eNqrLkpNt1KI5lJQqE7KLCm2UlAw1VHIS8xNtVJQ9w9Qr9VBkjGGyziGoMgYGsFlgpw9XXDJhQcEeaKaaA6XCw5xDAkNRpU1hMs6hQZHosgZmWCYGqujkJyfl5aZblWdk5iXClKko5BRXJCYnGplaGBkUlsLAD1BQo0=" alt="Bandwidth Allocation Control Register (`bc_alloc_ctl`)">
</div>
<div class="title">Figure 4. Bandwidth Allocation Control Register (<code>bc_alloc_ctl</code>)</div>
</div>
<div class="paragraph">
<p>The <code>OP</code> field instructs the bandwidth controller to perform an operation listed
in <a href="#BC_ALLOC_OP">Bandwidth Allocation Operations (<code>OP</code>)</a>. The <code>bc_alloc_ctl</code> register is used in conjunction with the
<code>bc_bw_alloc</code> register to perform bandwidth allocation operations. If the
requested operation uses the operands configured in <code>bc_bw_alloc</code>, software must
first program the <code>bc_bw_alloc</code> register with the operands for the operation
before requesting the operation.</p>
</div>
<table id="BC_ALLOC_OP" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Bandwidth Allocation Operations (<code>OP</code>)</caption>
<colgroup>
<col style="width: 16.3265%;">
<col style="width: 12.2448%;">
<col style="width: 71.4287%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operation</th>
<th class="tableblock halign-center valign-top">Encoding</th>
<th class="tableblock halign-center valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONFIG_LIMIT</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Establishes reserved bandwidth allocation for
                             requests by <code>RCID</code> and of access-type <code>AT</code>. The
                             bandwidth allocation is specified in <code>bc_bw_alloc</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>READ_LIMIT</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reads back the previously configured bandwidth
                             allocation for requests by <code>RCID</code> and of
                             access-type <code>AT</code>. The current configured allocation
                             is written to <code>bc_bw_alloc</code> on completion of the
                             operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3-23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">24-31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Designated for custom use.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p>A bandwidth allocation must be configured for each access-type supported by
the controller. When differentiated bandwidth allocation based on access-type
is not required, one of the access-types may be designated to hold a default
bandwidth allocation, and the other access-types can be configured to share the
allocation with the default access-type. If bandwidth is not allocated for each
access-type supported by the controller, the behavior is <code>UNSPECIFIED</code>.</p>
</div>
<div class="paragraph">
<p>When the <code>bc_alloc_ctl</code> register is written, the controller may need to perform
several actions that may not complete synchronously with the write. A write to
the <code>bc_alloc_ctl</code> sets the read-only <code>BUSY</code> bit to 1 indicating the controller
is performing the requested operation. When the <code>BUSY</code> bit reads 0, the operation
is complete, and the read-only <code>STATUS</code> field provides a status value (see
<a href="#BC_ALLOC_STS"><code>bc_alloc_ctl.STATUS</code> Field Encodings</a> for  details). Written values to the <code>BUSY</code> and the <code>STATUS</code>
fields are ignored. An implementation that can complete the operation
synchronously with the write may hardwire the <code>BUSY</code> bit to 0. The state of the
<code>BUSY</code> bit, when not hardwired to 0, shall only change in response to a write to
the register. The <code>STATUS</code> field remains valid until a subsequent write to the
<code>bc_alloc_ctl</code> register.</p>
</div>
<table id="BC_ALLOC_STS" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. <code>bc_alloc_ctl.STATUS</code> Field Encodings</caption>
<colgroup>
<col style="width: 14.6341%;">
<col style="width: 85.3659%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>STATUS</code></th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation was successfully completed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An invalid operation (<code>OP</code>) was requested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation was requested for an invalid <code>RCID</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation was requested for an invalid <code>AT</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An invalid or unsupported reserved bandwidth block was requested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6-63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future standard use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-127</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Designated for custom use.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="BC_BMASK"><a class="anchor" href="#BC_BMASK"></a>Bandwidth Allocation Configuration</h3>
<div class="paragraph">
<p>The <code>bc_bw_alloc</code> is used to program reserved bandwidth blocks (<code>Rbwb</code>) for an
<code>RCID</code> for requests of access-type <code>AT</code> using the <code>CONFIG_LIMIT</code> operation. If a
controller does not support bandwidth allocation, then the <code>bc_bw_alloc</code> register
is read-only zero.</p>
</div>
<div class="paragraph">
<p>The <code>bc_bw_alloc</code> holds the previously configured reserved bandwidth blocks for
an <code>RCID</code> and <code>AT</code> on successful completion of the <code>READ_LIMIT</code> operation.</p>
</div>
<div class="paragraph">
<p>Bandwidth is allocated in multiples of bandwidth blocks, and the value in <code>Rbwb</code>
must be at least 1 and must not exceed <code>MRBWB</code> value. Otherwise, the <code>CONFIG_LIMIT</code>
operation fails with <code>STATUS=5</code>. Additionally, the sum of <code>Rbwb</code> allocated
across all <code>RCIDs</code> must not exceed <code>MRBWB</code> value, or the <code>CONFIG_LIMIT</code> operation
fails with <code>STATUS=5</code>.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="https://kroki.io/wavedrom/svg/eNqrLkpNt1KI5lJQqE7KLCm2UjA001HIS8xNtVJQD0oqT1Kv1UHIKZjA5cIDgjxR5Szgcr7lqZnpGSWo0sZw6eKMxKLUFMcQVHlDuHxpcWowWAmKAmMjDLtjdRSS8_PSMtOtqnMS81KBioDuyyguSExOtTI0MDKprQUAK-hBtQ==" alt="Bandwidth Allocation Configuration Register (`bc_bw_alloc`)">
</div>
<div class="title">Figure 5. Bandwidth Allocation Configuration Register (<code>bc_bw_alloc</code>)</div>
</div>
<div class="paragraph">
<p>The <code>Rbwb</code>, <code>Mweight</code>, <code>sharedAT</code>, and <code>useShared</code> are all WARL fields.</p>
</div>
<div class="paragraph">
<p>Bandwidth allocation is typically enforced by the bandwidth controller over
finite accounting windows. The process involves measuring the bandwidth
consumption over an accounting window and determining if an <code>RCID</code> is exceeding
its bandwidth allocations for each access-types. The specifics of how the
accounting window is implemented are <code>UNSPECIFIED</code>, but is expected to provide
a statistically accurate control of the bandwidth usage over a few accounting
intervals.</p>
</div>
<div class="paragraph">
<p>The <code>Rbwb</code> field represents the bandwidth that is made available to an <code>RCID</code> for
requests that match <code>AT</code>, even when all other <code>RCID</code> are using their full
allocation of bandwidth. The bandwidth allocation scales linearly with the
number of bandwidth blocks programmed into <code>Rbwb</code>.</p>
</div>
<div class="paragraph">
<p>If there is non-reserved or unused bandwidth available in an accounting
interval, <code>RCIDs</code> may compete for additional bandwidth. The non-reserved or
unused bandwidth is proportionately shared among the competing <code>RCIDs</code> by using the
configured <code>Mweight</code> parameter, which is a number between 0 and 255. A larger
weight implies a greater fraction of the bandwidth. A weight of 0 implies that
the configured limit is a hard limit, and the use of unused or non-reserved
bandwidth is not allowed.</p>
</div>
<div class="paragraph">
<p>Sharing of non-reserved bandwidth is not differentiated by access-type identifier.
Therefore, the <code>Mweight</code> parameter must be programmed identically for all
access-type identifiers. If this parameter is programmed differently for each access-type
identifier, then the controller can use the parameter configured for any of the
identifiers, but the behavior is otherwise well defined.</p>
</div>
<div class="paragraph">
<p>When the <code>Mweight</code> parameter is not set to 0, the amount of unused bandwidth
allocated to <code>RCID=x</code> during contention with another <code>RCID</code> that is also
permitted to use unused bandwidth is determined by dividing the <code>Mweight</code> of
<code>RCID=x</code> by the sum of the <code>Mweight</code> of all other contending <code>RCIDs</code>. This
ratio <code>P</code> is determined by <a href="#eq-4">equation (2)</a>.</p>
</div>
<div id="eq-4" class="stemblock">
<div class="content">
\[\begin{equation}
P = \frac{Mweight_{x}}{\sum_{r=1}^{r=n} Mweight_{r}}
\end{equation}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The bandwidth enforcement is typically work-conserving, allowing unused bandwidth
 to be used by requestors that are enabled to use it, even if they have
consumed their <code>Rbwb</code> allotment.</p>
</div>
<div class="paragraph">
<p>When contending for unused bandwidth, the weighted share is typically
computed among the <code>RCIDs</code> that are actively generating requests in that
accounting interval and have a non-zero weight programmed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If unique bandwidth allocation is not required for an access-type identifier, then the
<code>useShared</code> parameter can be set to 1 for a <code>CONFIG_LIMIT</code> operation. When
<code>useShared</code> is set to 1, the <code>sharedAT</code> field specifies the access-type identifer with
which the bandwidth allocation is shared by the access-type identifier in
<code>bc_alloc_ctl.AT</code>. In this case, the <code>Rbwb</code> and <code>Mweight</code> fields are ignored,
and the configurations of the access-type identifier in <code>sharedAT</code> are applied. If the
access-type identifier specified by <code>sharedAT</code> does not have unique bandwidth allocation,
meaning that it has not been configured with <code>useShared=0</code>, then the behavior
is <code>UNSPECIFIED</code>.</p>
</div>
<div class="paragraph">
<p>The <code>useShared</code> and <code>sharedAT</code> fields are read-only zero if the bandwidth
controller does not support bandwidth allocation per access-type identifier.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When unique bandwidth allocation for an access-type identifier is not required, then one or
more identifiers might be configured with a shared bandwidth allocation. For
example, consider a bandwidth controller that supports 3 access-type identifers. The
access-type identifier 0 and 1 of <code>RCID</code> 3 are configured with unique bandwidth allocations
and the access-type identifier 2 is configured to share bandwidth allocation with
identifier 1. The example configuration is illustrated in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6669%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-center valign-top"><code>Rbwb</code></th>
<th class="tableblock halign-center valign-top"><code>Mweight</code></th>
<th class="tableblock halign-center valign-top"><code>useShared</code></th>
<th class="tableblock halign-center valign-top"><code>sharedAT</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RCID=3</code>, <code>AT=0</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>16</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N/A</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RCID=3</code>, <code>AT=1</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>16</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N/A</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RCID=3</code>, <code>AT=2</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N/A</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N/A</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="qos_capacity.html">Capacity-controller QoS Register Interface</a></span>
  <span class="next"><a href="qos_iommu.html">IOMMU Extension for QoS ID</a></span>
</nav>
</article>  </div>
</main>
<div class="modal micromodal-slide" id="modal-versions" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true">
            <main class="modal__content" id="modal-versions-content">
              <button data-micromodal-close class="modal-versions-close">
                <svg width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><defs><style>.cls-1h{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1h" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1h" x1="7" x2="25" y1="25" y2="7"/></g></svg>
              </button>
                  <ul class="nav-versions">
                      <li class="component">
                        <div>
                          <a class="title" href="../../ffh/v1.0/index.html">ACPI Functional Fixed Hardware</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../ffh/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../aia/v1.0/index.html">Advanced Interrupt Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../aia/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../etrace/v1.0/index.html">E-Trace Encapsulation Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../etrace/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../psabi/v1.0/index.html">ELF psABI Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../psabi/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../iommuArch/v1.0/index.html">IOMMU Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../iommuArch/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../isa/index.html">ISA Specifications</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../isa/index.html">
      default
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../reri/v1.0/index.html">RERI Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../reri/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="index.html">RISC-V Capacity and Bandwidth QoS Register Interface</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../plic/v1.0.0/index.html">RISC-V Platform-Level Interrupt Controller</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../plic/v1.0.0/index.html">
      v1.0.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../semihost/v1.0/index.html">semihosting</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../semihost/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                  </ul>
            </main>
        </div>
    </div>
</div>

</div>
<footer class="hidden">
</footer><script src="../../_/js/vendor/import.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/spring-tabs.js" data-sync-storage-key="docs:preferred-tab"></script>
  </body>
</html>
