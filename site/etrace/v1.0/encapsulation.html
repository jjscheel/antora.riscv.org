<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: RISC-V Ratified Specifications Library</title>
    <link rel="prev" href="contributors.html">
    <link rel="next" href="e-trace-specifics.html">
    <meta name="generator" content="Antora 3.1.12">
    <script>
!function (theme, navWidth) {
  if (theme === 'dark') document.documentElement.classList.add('dark-theme')
  if (navWidth) document.documentElement.style.setProperty('--nav-width', `${navWidth}px`)
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'),
  localStorage && localStorage.getItem('nav-width'))
    </script>
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/search.css">
    <link rel="stylesheet" href="../../_/css/vendor/page-search.css">
    <link rel="stylesheet" href="../../_/css/vendor/spring-tabs.css">

    <meta name="antora-ui-version" content="3f4ce2c51445edcfc62ee1f59ab97fffc218fb79"> 
    <meta name="version" content="v1.0">
    <meta name="component" content="etrace">
    <meta name="latest-version" content="false">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">RISC-V Ratified Specifications Library</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="etrace" data-version="v1.0">
  <aside class="nav">
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
        <nav class="nav-menu">
<div class="context">
  <span class="title">E-Trace Encapsulation Specification</span>
  <span class="version">v1.0</span>
  <button class="browse-version" id="browse-version">
    <svg
      height="24px"
      id="Layer_1"
      style="enable-background:new 0 0 512 512;"
      version="1.1"
      viewBox="0 0 512 512"
      width="24px"
      xml:space="preserve"
    ><g><path
          d="M256,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S273.7,224,256,224L256,224z"
        ></path><path
          d="M128.4,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S146,224,128.4,224L128.4,224z"
        ></path><path
          d="M384,224c-17.7,0-32,14.3-32,32s14.3,32,32,32s32-14.3,32-32S401.7,224,384,224L384,224z"
        ></path></g></svg>
  </button>
  </div><ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">E-Trace-Encapsulation Specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="contributors.html">Contributors</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link"  href="encapsulation.html">Encapsulation Format</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="e-trace-specifics.html">E-Trace Specifics</a>
  </li>
</ul>
  </li>
</ul>
          <div class="toggle-sm">
            <button id="nav-toggle-2" class="nav-toggle"></button>
          </div>
        </nav>
      </div>
      <div class="nav-collapse">
        <button id="nav-collapse-toggle"><span></span></button>        
      </div>
    </div>
    <div class="nav-resize"></div>
  </aside>
</div>
<script>
!function (sidebar) {
  if (sidebar) {
    document.body.classList.add('nav-sm')
  }
}(localStorage && localStorage.getItem('sidebar') === 'close')
</script><main class="article">
<div class="toolbar" role="navigation">
  <button id="nav-toggle-1" class="nav-toggle"></button>
</div>
  <div class="content">
<aside class="sidebar">
  <div class="content">
    <div
      class="toc"
      data-title=""
      data-levels="2"
    >
      <div class="toc-menu"></div>
    </div>
    <div class="sidebar-links">
        <a href="https://github.com/riscv-non-isa/e-trace-encap/edit/antora-refactor/modules/ROOT/pages/encapsulation.adoc">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            viewBox="0 0 24 24"
            width="24"
          ><path
              d="m16 2.012 3 3L16.713 7.3l-3-3zM4 14v3h3l8.299-8.287-3-3zm0 6h16v2H4z"
            ></path></svg>
          Edit this Page
        </a>
              <a href="https://github.com/riscv-non-isa/e-trace-encap" title="GitHub">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          GitHub Project
        </a>

      <a href="" title="PDF">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          Download PDF
        </a>
    </div>
  </div>
</aside>
<article class="doc">
<div class="breadcrumbs-container">
  <nav class="breadcrumbs" aria-label="breadcrumbs">
    <ul>
      <li><a href="index.html">E-Trace Encapsulation Specification</a></li>
      <li>E-Trace-Encapsulation Specification</li>
      <li><a href="encapsulation.html">Encapsulation Format</a></li>
    </ul>
  </nav>
</div><div class="sect1">
<h2 id="chapter2"><a class="anchor" href="#chapter2"></a>Packet Encapsulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two types of encapsulation are defined: <em>normal</em> and <em>null</em>. A transmitted stream of encapsulated packets comprises a mixture of <em>normal</em> and <em>null</em> packets.  Each packet is atomic, and must be transmitted in its entirety before another packet can be sent.</p>
</div>
<div class="sect2">
<h3 id="normal-encapsulation-structure"><a class="anchor" href="#normal-encapsulation-structure"></a>Normal Encapsulation Structure</h3>
<div class="paragraph">
<p>The normal encapsulation structure is comprised of four field-groups as shown in <a href="#_table_Groups">Encapsulation Field Groups</a>.  In this and the following tables, the field-groups and fields are listed in transmission order: the uppermost field-group or field in a table is transmitted first, and multi-bit fields are transmitted least significant bit first.</p>
</div>
<table id="_table_Groups" class="tableblock frame-all grid-all stripes-even stretch">
<caption class="title">Table 1. Encapsulation Field Groups</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 8.3333%;">
<col style="width: 75.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Group Name</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;"># Bits</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"> <strong>header</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Encapsulation header.  See <a href="#_section_Header">Header</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>srcID</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">0 - 16</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Source ID.  See <a href="#_section_srcID">srcID</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>timestamp</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">T*8</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Time stamp.  See <a href="#_section_Timestamp">Timestamp</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>payload</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">1-248</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Packet payload.  See <a href="#_section_Payload">Payload</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The groups are defined in the following sections:</p>
</div>
<div class="sect3">
<h4 id="_section_Header"><a class="anchor" href="#_section_Header"></a>Header</h4>
<div class="paragraph">
<p>The header is a single byte comprising the fields defined in  <a href="#_table_Header">Header Fields</a>.</p>
</div>
<table id="_table_Header" class="tableblock frame-all grid-all stripes-even stretch">
<caption class="title">Table 2. Header Fields</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 8.3333%;">
<col style="width: 75.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Field Name</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;"># Bits</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"> <strong>length</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Encapsulated payload length.  A value of <em>L</em> indicates an <em>L</em> byte payload.  Must be &gt; 0 - see <a href="#_section_null_encapsulation">Null Encapsulation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>flow</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Flow indicator.  This can be used to direct packets to a particular sink in systems where multiple sinks exist, and those sinks include the ability to accept or discard packets based on the flow value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>extend</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Indicates presence of timestamp when 1.  Must be 0 if timestamp width is 0.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="_section_srcID"><a class="anchor" href="#_section_srcID"></a>srcID</h4>
<div class="paragraph">
<p>The <strong>srcID</strong> field identifies the source of the packet.  It can be between 0 and 16 bits in length.  This length must be fixed and discoverable for a given system.</p>
</div>
<div class="paragraph">
<p>The <strong>srcID</strong> may be omitted (i.e. zero bits in length) if there is only one source in the system, or if the transport scheme includes a sideband bus for the source ID (for example, ATB).</p>
</div>
<div class="paragraph">
<p>When present, an 8-bit <strong>srcID</strong> will be sufficient for most use cases, and is simplest in terms of determining the packet length, keeping all field groups aligned to byte boundaries.  However, the length of the field can be reduced to improve efficiency for small systems, or increased if required for larger systems. This is explained in more detail in <a href="#_section_packet_length">Packet Length</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_section_Timestamp"><a class="anchor" href="#_section_Timestamp"></a>Timestamp</h4>
<div class="paragraph">
<p>The <strong>timestamp</strong> field provides a means to include time information with every packet.  It is included in the encapsulation if <strong>header.extend</strong> is 1.  When included, the timestamp must be T bytes in length.  The length must be discoverable, and fixed for a given system.</p>
</div>
<div class="paragraph">
<p>Timestamps may be omitted either because time is not of interest to the user, or if time information is already included within the encapsulated payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="_section_Payload"><a class="anchor" href="#_section_Payload"></a>Payload</h4>
<div class="paragraph">
<p>The encapsulation payload can be up to 248 bits (31 bytes) in length, and comprises the fields shown in table <a href="#_table_payload">Payload Fields</a>.</p>
</div>
<table id="_table_payload" class="tableblock frame-all grid-all stripes-even stretch">
<caption class="title">Table 3. Payload Fields</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 8.3333%;">
<col style="width: 75.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Field Name</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;"># Bits</th>
<th class="tableblock halign-left valign-top" style="background-color: lightblue;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"> <strong>type</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">&#8805; 0</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Packet type.  May be eliminated (i.e. width set to 0) for sources with only one packet type.  Length must be fixed for a given <strong>srcID</strong>, and discoverable if &gt; 0.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock"><strong>trace_payload</strong></p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">&#8804; R</p></td>
<td class="tableblock halign-left valign-top" style="background-color: !;"><p class="tableblock">Packet payloads such as those defined for E-Trace.<br>
Maximum value of R is defined as 248 - Y - <strong>srcID</strong>%8, where Y is the length of the <strong>type</strong> field.  See <a href="#_section_packet_length">Packet Length</a> for details of the relationship between <strong>srcID</strong> and payload length.</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect3">
<h4 id="_section_packet_length"><a class="anchor" href="#_section_packet_length"></a>Packet Length</h4>
<div class="paragraph">
<p>Encapsulated packets are a number of whole bytes in length, the exact number depending on the sizes of the <strong>srcID</strong>, <strong>timestamp</strong> (if present) and <strong>header.length</strong>:</p>
</div>
<div class="paragraph text-center">
<p>Packet length = 1 + S + (T * <strong>header.extend</strong>) + <strong>header.length</strong></p>
</div>
<div class="paragraph">
<p>S and T are discoverable constants; S is the number of whole bytes of <strong>srcID</strong>: int(#bits(<strong>srcID</strong>)/8).</p>
</div>
<div class="paragraph">
<p>For the case where the size of <strong>srcID</strong> is a multiple of 8 bits, <strong>header.length</strong> is simply the number of bits of payload rounded up to the nearest multiple of 8 and expressed in bytes:</p>
</div>
<div class="paragraph text-center">
<p><strong>header.length</strong> = ceiling(#bits(<strong>payload</strong>)/8)</p>
</div>
<div class="paragraph">
<p>However, if the <strong>srcID</strong> is not a multiple of 8 bits the remaining <strong>srcID</strong> bits not accounted for by 'S' are instead included when determining the value of <strong>header.length</strong>.  Thus the more general definition for any <strong>srcID</strong> size is:</p>
</div>
<div class="paragraph text-center">
<p><strong>header.length</strong> = ceiling((#bits(<strong>payload</strong>) + #bits(<strong>srcID</strong>)%8)/8)</p>
</div>
<div class="paragraph">
<p>In this way, the maximum payload length is reduced by up to 7 when the <strong>srcID</strong> is not a multiple of 8 bits.</p>
</div>
<div class="paragraph">
<p>In cases where the number of bits of <strong>payload</strong> + <strong>srcID</strong> is not a multiple of 8, some padding bits are required.  These must be placed in the most significant bits of the final byte of the packet.  Their value is "don&#8217;t care", but they must not "leak" information (for example, the previous contents of an intermediate buffer that may relate to a different trace session which the current recipient of trace is not authorised to receive).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_section_null_encapsulation"><a class="anchor" href="#_section_null_encapsulation"></a>Null Encapsulation</h3>
<div class="paragraph">
<p>For <em>normal</em> encapsulation, the <strong>header.length</strong> field is at least 1, and the overall length of the encapsulated packet will be at least 2 bytes (<strong>header</strong> plus 1 byte of payload).</p>
</div>
<div class="paragraph">
<p>A <em>null</em> packet is specified as consisting exclusively of one <strong>header</strong> byte with its <strong>length</strong> field set to zero, explicitly indicating the packet&#8217;s total size as one byte.  The  <strong>extend</strong> field is used to distinguish 2 different types of null packet, which are defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>extend</strong> = 0: <em>null.idle</em></p>
</li>
<li>
<p><strong>extend</strong> = 1: <em>null.alignment</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Usually, <em>null.idle</em> will be used.  <em>null.alignment</em> is used for synchronization, as described in the following section.</p>
</div>
<div class="paragraph">
<p>Insertion of <em>null</em> packets typically occurs at a trace sink where there are no sideband signals accompanying the data stream to identify valid data. Packets emitted from a trace source are generally transported over some form of on-chip transport (e.g. ATB) that includes sideband signalling to indicate when data is valid.  In this situation when there is no data to send, valid is simply deasserted.  That said, the <strong>flow</strong> field definition in <em>null</em> packets is unchanged, so <em>null</em> packets can be routed from a trace source to a specific sink if required.  When generated at a sink, the <strong>flow</strong> field value is unimportant and is typically 0. If the sink is generating a bit stream (i.e. the byte boundaries are not inherently known to the recipient) then the <strong>flow</strong> field must be zero in all <em>null</em> packets within the generated bitstream.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization"><a class="anchor" href="#synchronization"></a>Synchronization</h3>
<div class="paragraph">
<p>In a data stream comprised of packets, it’s a requirement to be able to determine where packets start and end, when starting from an arbitrary point, without knowledge of the full packet history.  This can be achieved by inserting a synchronization sequence into the packet stream.  This sequence is comprised of a sufficiently long sequence of <em>null</em> packets.</p>
</div>
<div class="paragraph">
<p>A 'null' byte is defined as a byte with the 5LSBs all zero, which may be a <em>null</em> packet, or may be part of a <em>normal</em> packet.  The longest run N of ‘null’ bytes possible within a <em>normal</em> packet is:</p>
</div>
<div class="paragraph text-center">
<p>N =  31 + T + S
(see <a href="#_section_Timestamp">Timestamp</a> and <a href="#_section_packet_length">Packet Length</a> for definitions of T and S respectively)</p>
</div>
<div class="paragraph">
<p>Therefore, in a sequence of N or more ‘null’ bytes, the first N 'null' bytes may actually be part of a packet.  However, any 'null' bytes after this must be <em>null</em> packets, and the 1st non-null byte seen after this must therefore be the 1st byte of a <em>normal</em> packet.</p>
</div>
<div class="paragraph">
<p>For unframed data streams such as PIB, a <em>null.alignment</em> packet must be transmitted as the final <em>null</em> before a <em>normal</em> packet.  Strictly speaking this is necessary only if the data stream is sent via an interface less than 8 bits wide, but for simplicity this is mandatory for any width.  The single 1 at the end of this sequence uniquely identifies the byte boundary, and what follows as the start of a packet. For example, for two <em>normal</em> packets with M <em>nulls</em> between them, this would comprise M-1 <em>null.idles</em> and 1 <em>null.alignment</em> (M &gt; 0).</p>
</div>
<div class="paragraph">
<p>For framed data streams which incorporate synchronization information in their own framing such as MIPI TWP (aka ARM Trace Formatter Protocol) or USB there is no requirement to include <em>null.alignment</em> packets.</p>
</div>
<div class="paragraph">
<p>The synchronization requirements are summarized in the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A synchronization sequence must have a length of N+1 bytes (N defined above), comprising:</p>
<div class="ulist">
<ul>
<li>
<p>For unframed data streams, N consecutive <em>null.idle</em> packets, directly followed by one <em>null.alignment</em> packet;</p>
</li>
<li>
<p>For framed data streams, N consecutive <em>null.idle</em> packets, directly followed by one <em>null.idle</em> or <em>null.alignment</em> packet.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Synchronization sequences are typically inserted periodically.  In addition, a sufficiently long run of <em>null</em> packets (due to a lack of <em>normal</em> packets to send) may also serve as an 'opportunistic' synchronization sequence.  For unframed data streams, this requires <em>null.alignment</em> packets to be included, either as every (N+1)th <em>null</em>, or as the final <em>null</em>.</p>
</div>
<div class="paragraph">
<p>For writing unframed data to memory, alternative synchronisation mechanisms may also be employed.   For example, by dividing memory into blocks of known size, and requiring that packets do not straddle block boundaries.  The first byte of every block will therefore be the start of a packet.  Details of such schemes are out of scope of this specification.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="contributors.html">Contributors</a></span>
  <span class="next"><a href="e-trace-specifics.html">E-Trace Specifics</a></span>
</nav>
</article>  </div>
</main>
<div class="modal micromodal-slide" id="modal-versions" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true">
            <main class="modal__content" id="modal-versions-content">
              <button data-micromodal-close class="modal-versions-close">
                <svg width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><defs><style>.cls-1h{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1h" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1h" x1="7" x2="25" y1="25" y2="7"/></g></svg>
              </button>
                  <ul class="nav-versions">
                      <li class="component">
                        <div>
                          <a class="title" href="../../ffh/v1.0/index.html">ACPI Functional Fixed Hardware</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../ffh/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../aia/v1.0/index.html">Advanced Interrupt Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../aia/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="index.html">E-Trace Encapsulation Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../psabi/v1.0/index.html">ELF psABI Specification</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../psabi/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../iommuArch/v1.0/index.html">IOMMU Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../iommuArch/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../isa/index.html">ISA Specifications</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../isa/index.html">
      default
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../reri/v1.0/index.html">RERI Architecture</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../reri/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../qos/v1.0/index.html">RISC-V Capacity and Bandwidth QoS Register Interface</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../qos/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../plic/v1.0.0/index.html">RISC-V Platform-Level Interrupt Controller</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../plic/v1.0.0/index.html">
      v1.0.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                      <li class="component">
                        <div>
                          <a class="title" href="../../semihost/v1.0/index.html">semihosting</a>
                        </div>                        <div class="version-item is-active">
                          <div>
                            <button class="version-toggle" type="button">
                              <span></span>
                              Stable
                            </button>
                          </div>
                          <ul class="versions">
  <li class="version">
    <a href="../../semihost/v1.0/index.html">
      v1.0
    </a>
  </li>
</ul>                        </div>
                        
                      </li>
                  </ul>
            </main>
        </div>
    </div>
</div>

</div>
<footer class="hidden">
</footer><script src="../../_/js/vendor/import.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/spring-tabs.js" data-sync-storage-key="docs:preferred-tab"></script>
  </body>
</html>
